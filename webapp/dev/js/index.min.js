$(function () {
	var util = {
		ajax:function (url,callback,data,type) {
			$.ajax({
				url:url,
				type:type || 'GET',
				dataType:'json',
				data:data || {},
				success:function(d){
					callback(d);
				},
				error:function(error){

				}
			})
		},
		level3:function ($dom) {
			$dom.on('change',function () {
				var next = $(this).next();
				util.ajax('/getOption.json',function (d) {
					next.empty().append(template('tpl-level-box',d));
				});
			});
		},
		hoverBind:function ($dom,callback) {
			$dom.on('click',function () {
				$(this).addClass('active').siblings('.active').removeClass('active');
				callback($(this));
			});
		}
	};
	var nav = {
		init:function () {
			this.eventBind();
		},
		eventBind:function () {
			this.selectToggle();
		},
		selectToggle:function () {
			// $('.dropdown-toggle').dropdown();
			$('#myToggler').on('hide.bs.dropdown',function (e) {
				console.log($(this));
			})
		}
	};

	var menu = {
		menus:[{
			icon:'icon-tubiao210 active'
		},{
			icon:'icon-baobiao'
		},{
			icon:'icon-icon'
		},{
			icon:'icon-erji3'
		}],
		init:function () {
			this.initMenu();
			this.eventBind();
		},
		initMenu:function () {
			$('#sidebar-box').empty().append(template('../template/utilTemplate.html',this.menus));
		},
		eventBind:function () {
			this.tabBind();
			this.sideMenu();
		},
		tabBind:function () {
			$('#myTab').find('a').on('click',function (e) {
				e.preventDefault();
				$(this).tab('show')
			})
		},
		sideMenu:function () {
			util.hoverBind($('#sidebar-box').find('.iconfont'),function ($this) {

			});
		}
	};

	var content = {
		init:function () {
			this.getTabel();
			this.eventBind();
		},
		eventBind:function () {
			this.levelBind();
			this.listBind();
		},
		getTabel:function(){
			util.ajax('/getTable.json',function (d) {
				$('#table-body').empty().html(template('tpl-table-body',d));
			})
		},
		levelBind:function () {
			var $one = $('#con-select').find('.one'),
				$two = $('#con-select').find('.two'),
				$three = $('#con-select').find('.three');
			util.ajax('/getOption.json',function (d) {
				$one.empty().append(template('tpl-level-box',d));
			});
			util.level3($one);
			util.level3($two);
		},
		listBind:function () {
			var $lists = $('#list-box').find('.lists');
			util.hoverBind($lists);
		}
	};

	nav.init();
	menu.init();
	content.init();

});
